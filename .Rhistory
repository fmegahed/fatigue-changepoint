knitr::opts_chunk$set(echo = TRUE)
rm(list = ls()) # clear global environment
graphics.off() # close all graphics
library(pacman) # needs to be installed first
p_load(R.matlab, plotly, extrafont, grDevices, gridExtra,
dplyr, stringr, tidyverse, utils, reshape2,
anomalize, forecast, MVN, fractal,
ecp, dfphase1)
install.packages("dtwclust")
require("dtwclust")
require(dtwclust)
require('dtwclust')
knitr::opts_chunk$set(echo = TRUE)
load(file = "./Data/RGenerated/MedianFilteredData.RData")
View(subject1_median_diff_f)
View(subject1_medianf)
View(subject1_median_diff_f)
View(subject1_medianf)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
medianfilt <- get(paste0("subject",i,"_medianf"))
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(medianfilt_norm)
View(medianfilt)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- normalize(df[,2], method = "standardize", range = c(0, 100), margin = 1L, on.constant = "quiet") # scale of 0-100
norm.stride.height <- normalize(df[,3], method = "standardize", range = c(0, 100), margin = 1L, on.constant = "quiet") # scale of 0-100
norm.stride.duration <- normalize(df[,4], method = "standardize", range = c(0, 100), margin = 1L, on.constant = "quiet") # scale of 0-100
# Remove the observations corresponding to the outliers
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
}
install.packages("normalr")
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- normalize(df[,2], method = "standardize", range = c(0, 100), margin = 1L, on.constant = "quiet") # scale of 0-100
norm.stride.height <- normalize(df[,3], method = "standardize", range = c(0, 100), margin = 1L, on.constant = "quiet") # scale of 0-100
norm.stride.duration <- normalize(df[,4], method = "standardize", range = c(0, 100), margin = 1L, on.constant = "quiet") # scale of 0-100
# Remove the observations corresponding to the outliers
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
}
dat <- data.frame(x = rnorm(10, 30, .2), y = runif(10, 3, 5))
View(dat)
scaled.dat <- scale(dat)
View(scaled.dat)
apply(scaled.dat, 2, sd)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- 50*(scale(df[,2])+1) # scale of 0-100
norm.stride.height <- 50*(scale(df[,3])+1) # scale of 0-100
norm.stride.duration <- 50*(scale(df[,4])+1) # scale of 0-100
# Remove the observations corresponding to the outliers
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(subject1_norm)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
# Remove the observations corresponding to the outliers
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(subject1_norm)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
# Remove the observations corresponding to the outliers
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
colnames(get(paste0("subject",i,"_norm"))) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
}
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
# Remove the observations corresponding to the outliers
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
colnames(paste0("subject",i,"_norm")) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
}
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
colnames(paste0("subject",i,"_norm")) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
}
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
colnames(df) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(subject1_norm)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
df_norm <- get(paste0("subject",i,"_medianf"))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(subject1_norm)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
colnames(paste0("subject",i,"_medianf")) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
}
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
assign(paste0("subject",i,"_norm"),
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
colnames(paste("subject",i,"_medianf")) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
}
paste0("subject",i,"_medianf")
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
assign(df_norm,
data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration)))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
paste0("subject",i,"_norm") <- df_norm
}
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
paste0("subject",i,"_norm") <- df_norm
}
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_norm"), df_norm)
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(subject1_norm)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_median_norm"), df_norm)
medianfilt_norm[[i]] <- get(paste0("subject",i,"_median_norm"))
df <- get(paste0("subject",i,"_cusum")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- scale(df[,2]) # scale of 0-100
norm.stride.height <- scale(df[,3]) # scale of 0-100
norm.stride.duration <- scale(df[,4]) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_cusum_norm"), df_norm)
cusum_norm[[i]] <- get(paste0("subject",i,"_cusum_norm"))
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(cusum_norm)
min(norm.stride.len)
max(norm.stride.len)
range(norm.stride.len)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- 100*(df[,2]-min(df[,2]))/(max(df[,2])-min(df[,2])) # scale of 0-100
norm.stride.height <- 100*(df[,3]-min(df[,3]))/(max(df[,3])-min(df[,3])) # scale of 0-100
norm.stride.duration <- 100*(df[,4]-min(df[,4]))/(max(df[,4])-min(df[,4])) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_median_norm"), df_norm)
medianfilt_norm[[i]] <- get(paste0("subject",i,"_median_norm"))
df <- get(paste0("subject",i,"_cusum")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- 100*(df[,2]-min(df[,2]))/(max(df[,2])-min(df[,2])) # scale of 0-100
norm.stride.height <- 100*(df[,3]-min(df[,3]))/(max(df[,3])-min(df[,3])) # scale of 0-100
norm.stride.duration <- 100*(df[,4]-min(df[,4]))/(max(df[,4])-min(df[,4])) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_cusum_norm"), df_norm)
cusum_norm[[i]] <- get(paste0("subject",i,"_cusum_norm"))
}
#save(changepoints_subj_ecp, changepoints_subj_thr, changepoints_cusum_subj_ecp,
#     file = "./Data/RGenerated/ChangepointsRPE.RData")
View(cusum_norm)
View(subject1_median_norm)
min(norm.stride.height)
max(norm.stride.height)
# to load previously generated data and changepoints
load(file = "./Data/RGenerated/MedianFilteredData.RData")
load(file = "./Data/RGenerated/CusumData.RData")
medianfilt_norm <- list()
cusum_norm <- list()
for (i in 1:15) {
cat('###',paste0("P", i), "{-}",'\n')
df <- get(paste0("subject",i,"_medianf")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- 100*(df[,2]-min(df[,2]))/(max(df[,2])-min(df[,2])) # scale of 0-100
norm.stride.height <- 100*(df[,3]-min(df[,3]))/(max(df[,3])-min(df[,3])) # scale of 0-100
norm.stride.duration <- 100*(df[,4]-min(df[,4]))/(max(df[,4])-min(df[,4])) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_median_norm"), df_norm)
medianfilt_norm[[i]] <- get(paste0("subject",i,"_median_norm"))
df <- get(paste0("subject",i,"_cusum")) # Getting Data from Sec.
# Normalizing each of the three variables
time.from.start <- df[,1]
norm.stride.len <- 100*(df[,2]-min(df[,2]))/(max(df[,2])-min(df[,2])) # scale of 0-100
norm.stride.height <- 100*(df[,3]-min(df[,3]))/(max(df[,3])-min(df[,3])) # scale of 0-100
norm.stride.duration <- 100*(df[,4]-min(df[,4]))/(max(df[,4])-min(df[,4])) # scale of 0-100
df_norm <- data.frame(cbind(time.from.start, norm.stride.len,
norm.stride.height, norm.stride.duration))
colnames(df_norm) <- c("time.from.start", "norm.stride.len",
"norm.stride.height", "norm.stride.duration")
assign(paste0("subject",i,"_cusum_norm"), df_norm)
cusum_norm[[i]] <- get(paste0("subject",i,"_cusum_norm"))
}
cat(paste0('</b> </font> The normalized data can be found at: <a href="https://github.com/fmegahed/fatigue-changepoint/blob/master/Data/RGenerated/NormMedianFilteredData.RData">NormMedianFilteredData.RData</a> and <a
href="https://github.com/fmegahed/fatigue-changepoint/blob/master/Data/RGenerated/NormCusumData.RData">NormCusumData.RData</a> </p> </source>')
)
save(medianfilt_norm,
file = "./Data/RGenerated/NormMedianFilteredData.RData")
save(cusum_norm,
file = "./Data/RGenerated/NormCusumData.RData")
